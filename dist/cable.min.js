/*.......................................
. cablejs: By Wyatt Allen, MIT Licenced .
. 2014-03-31T19:18:35.507Z              .
.......................................*/
'use strict';var Cable={};
(function(){function c(a,d){for(var g in a)a.hasOwnProperty(g)&&d(a[g],g)}function b(a){return a.argAliases?a.argAliases:(a+"").match(/^function(\s*)?\(([^)]*)\)/m)[2].split(",").map(function(a){return a.replace(/(^\s+)|(\s+$)/g,"")})}function e(a,d){return b(a).filter(function(a){return-1==r.indexOf(a)}).map(function(a){return a.replace(/^_/,"")})}function k(a,d){return b(a).filter(function(a){return-1==r.indexOf(a)&&"_"!=a[0]})}function h(a){var d={};return a&&"[object Function]"===d.toString.call(a)}
function l(a,d){if(d){var g={};c(a,function(a,f){g[f]=d.hasOwnProperty(f)?d[f]:a});return g}return a}function n(a){function d(g){if(g.length){var b=g[0],c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a="("+this.responseText+")";delete f[b];var c={};try{c[b]=eval(a)}catch(e){throw"Failed to load module '"+b+"': "+e;}Cable.define(c,{reify:!1,wireup:!1});d(g.slice(1))}};c.open("get",f[b].url,!0);c.send()}else a()}var g=[],b;for(b in f)f.hasOwnProperty(b)&&
"module"===f[b].type&&g.push(b);d(g)}function m(a,d){for(var g=d.chain,b="main"===a?"":"_"+a,c=[],e=0;e<g.length;++e)c.push(g.slice(0,g.length-e).join("_")+b);c.push(a);for(g=0;g<c.length;++g)if(f.hasOwnProperty(c[g]))return c[g];return null}function v(){c(f,function(a){a.out=[]});c(f,function(a,d){a.fn&&k(a.fn,a.context).forEach(function(g){var b=m(g,a.scope);if(b)f[b].out.push(d);else throw"Reference to undefined node '"+g+"' as dependency of '"+d+"'";})})}function x(){c(f,function(a,d){if("subdefinition"===
a.type)if(y(d))s(d,function(g){g.splice(a.defineIndex,0,function(g){var b={};b[d]=g;Cable.define(b,{scope:a.scope})});delete f[d];a.fn.apply(window,g)});else throw"Illegal subdefinition: "+d+". Subdefs must depend only on libraries";})}function z(){c(f,function(a,d){"event"!==a.type||a.isWiredUp||(a.wireup(function(a){p(d,function(d){d(a)})}),a.isWiredUp=!0)})}function p(a,d){if(f.hasOwnProperty(a))A[f[a].type](a,d);else throw"Cannot generate: '"+a+"' is not defined";}function q(a,d,g,b){void 0===
g&&(g=[]);a.length?b&&b.hasOwnProperty(a[0])?q(a.slice(1),d,g.concat([b[a[0]]]),b):p(a[0],function(f){q(a.slice(1),d,g.concat([f]),b)}):d(g)}function s(a,d){var b=f[a]["in"].map(function(d){return m(d,f[a].scope)});q(b,d)}function t(a,d){B[f[a].type](a,d)}function u(a){t(a,function(){})}function y(a){return f[a]["in"].map(function(d){return"library"===f[m(d,f[a].scope)].type}).reduce(function(a,b){return a&&b})}var r=["result","respond","type","event","define"],f={};Cable._debug=function(){return f};
Cable.each=c;Cable.define=function(a,d){d=l({reify:!0,wireup:!0,scope:{chain:[]}},d);c(a,function(a,c){if(/^_/.test(c))throw"Illegal definition: names cannot begin with an underscore.";if(-1!=r.indexOf(c))throw"Illegal definition: "+c+" is a reserved word.";if(f.hasOwnProperty(c))throw"Illegal definition: "+c+" is already defined.";var e=null;a.hasOwnProperty("type")?e=a.type:h(a)?(e=a,-1!=b(e).indexOf("result")||-1!=b(e).indexOf("respond")?e="synthetic":-1!==b(a).indexOf("define")?e="subdefinition":
(e=b(a),1===e.length&&"event"===e[0]?(e="event",a={type:"event",wireup:a}):e="effect")):e="scope";if(w.hasOwnProperty(e))w[e](c,a,d.scope);else throw"Illegal definiton: could not determine meaning of "+c;});(d.reify||d.wireup)&&n(function(){d.reify&&(v(),x(),v());d.wireup&&z()})};var w={data:function(a,d,b){f[a]={type:"data",value:d.value,"in":[],out:[],helpers:d.helpers?d.helpers:{},scope:b}},synthetic:function(a,d,c){-1!=b(d).indexOf("respond")?f[a]={type:"synthetic",fn:d,value:null,invoked:!1,
"in":e(d,d.context),out:[],resultIndex:b(d).indexOf("respond"),scope:c,coalesce:!1}:f[a]={type:"synthetic",fn:d,value:null,invoked:!1,"in":e(d,d.context),out:[],resultIndex:b(d).indexOf("result"),scope:c,coalesce:!0}},effect:function(a,d,b){f[a]={type:"effect",fn:d,"in":e(d,d.context),out:[],scope:b}},event:function(a,d,b){f[a]={type:"event",value:d.defaultValue,wireup:d.wireup,isWiredUp:!1,invoked:!1,"in":[],out:[],scope:b}},library:function(a,d,b){f[a]={type:"library",path:d.path,shim:d.shim,handle:null,
loaded:!1,scope:b}},scope:function(a,d,b){var f={};c(d,function(d,b){f["main"===b?a:a+"_"+b]=d});Cable.define(f,{reify:!1,wireup:!1,scope:{chain:b.chain.concat([a.replace(/^.+_/,"")])}})},subdefinition:function(a,d,c){f[a]={type:"subdefinition",in:e(d),fn:d,scope:c,defineIndex:b(d).indexOf("define")}},module:function(a,d,b){f[a]={type:"module",url:d.url,scope:b}}},A={data:function(a,d){var b=function(){if(!arguments.length)return f[a].value;arguments[0]!=f[a].value&&(f[a].value=arguments[0],f[a].out.forEach(u))};
c(f[a].helpers,function(a,d){b[d]=function(){return a.apply(b,arguments)}});d(b)},synthetic:function(a,d){f[a].invoked?d(function(){return f[a].value}):t(a,function(){})},effect:function(){},event:function(a,d){d(function(){if(!arguments.length)return f[a].value;arguments[0]==f[a].value&&f[a].coalesce||(f[a].invoked=!0,f[a].value=arguments[0],f[a].out.forEach(u))})},library:function(a,d){f[a].loaded?d(f[a].handle):t(a,function(){p(a,d)})}},B={data:p.data,event:p.event,synthetic:function(a,d){s(a,
function(b){b.splice(f[a].resultIndex,0,function(b){f[a].invoked=!0;f[a].value==b&&f[a].coalesce||(f[a].value=b,f[a].out.forEach(u));d()});f[a].fn.apply({},b)})},effect:function(a,b){s(a,function(c){f[a].fn.apply({},c);b()})},library:function(a,b){if(f[a].loaded)b();else{var c=function(){var b,d,c={},e=0;arguments[e].substring&&e++;b=arguments[e].splice?arguments[e++]:["require","exports","module"];if(h(arguments[e])){var k=arguments[e];d=-1!==b.indexOf("exports")?function(){var a=k.apply(window,
arguments);return void 0!==a?a:c}:k}else{var g=arguments[e];d=function(){return g}}q(b,function(b){f[a].handle=d.apply(window,b);f[a].loaded=!0},[],{require:function(){throw"Cable.js AMD loader does not support CommonJS style require.";},exports:c,module:null})};c.amd={};var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=this.responseText;f[a].shim&&(e=["define(function() {",e,"\nreturn ",f[a].shim,"; });"].join(""));window.define=c;eval(e);delete window.define;
"$"===a&&$&&$.noConflict&&$.noConflict();b()}};e.open("get",f[a].path,!0);e.send()}}};Cable.initialize=function(a,b){"synthetic"===f[a].type&&(f[a].value=b,f[a].invoked=!0)}})();Cable.withArgs=function(c,b){b.argAliases=c;return b};Cable.data=function(c,b){var e={type:"data",value:c};b&&(e.helpers=b);return e};Cable.define({init:{type:"event",wireup:function(c){c(new Date)}}},{reify:!1,wireup:!1});
Cable.list=function(c){return{array:Cable.data(c),main:Cable.data({type:"initialize",array:c},{insertAt:function(b,c){this({type:"insert",index:b,element:c})},prepend:function(b){this({type:"insert",index:0,element:b})},append:function(b){this({type:"insert",index:-1,element:b})},updateAt:function(b,c){this({type:"update",index:b,updates:c})},deleteAt:function(b){this({type:"delete",index:b})}}),updater:Cable.withArgs(["main","_array"],function(b,c){var k=b(),h=c().slice(0);if("insert"===k.type)h.splice(0<=
k.index?k.index:h.length,0,k.element);else if("update"===k.type)for(var l in k.updates)k.updates.hasOwnProperty(l)&&(h[k.index][l]=k.updates[l]);else"delete"===k.type&&h.splice(k.index,1);c(h)})}};
Cable.interval=function(c,b){if(c.substring){var e=[c,"_pid"];b&&(e=e.concat("init"));return{pid:Cable.data(-1),main:Cable.withArgs(e,function(b,c,e){clearInterval(c());b=setInterval(function(){e(new Date)},b());c(b)})}}return{type:"event",defaultValue:new Date,wireup:function(e){setInterval(function(){e(new Date)},c);b&&e(new Date)}}};Cable.library=function(c,b){return{type:"library",path:c,shim:b}};Cable.module=function(c){return{type:"module",url:c}};
Cable.pack=function(c){var b=function(c){for(var k={},h=1;h<b.argAliases.length;++h)k[b.argAliases[h]]=arguments[h]();c(k)};c=c.slice(0);c.splice(0,0,"result");b.argAliases=c;return b};Cable.counter=function(){return Cable.data(-1,{next:function(){var c=this()+1;this(c);return c}})};Cable.textbox=function(c){return Cable.withArgs(["$","define"],function(b,e){e(Cable.withArgs(["event"],function(e){var h=b(c),l=function(){return h.is("[type='number']")?parseFloat(h.val()):h.val()};h.on("change keyup",function(){e(l())});e(l())}))})};Cable.checkbox=function(c){return Cable.withArgs(["$","define"],function(b,e){var k=b(c);e(Cable.withArgs(["event"],function(b){k.on("change",function(){b(k.is(":checked"))});b(k.is(":checked"))}))})};
Cable.button=function(c){return Cable.withArgs(["$","define"],function(b,e){e(Cable.withArgs(["event"],function(e){b(c).on("click",function(){e(new Date)})}))})};Cable.returnKey=function(c){return Cable.withArgs(["$","define"],function(b,e){e({type:"event",wireup:function(e){b(c).on("keyup",function(b){13===b.keyCode&&e(new Date)})}})})};
Cable.template=function(c,b){var e=(b.match(/\{\{[_a-zA-Z0-9]+\}\}/g)||[]).map(function(b){return b.replace(/\{|\}/g,"")});return{properties:Cable.pack(e),main:Cable.withArgs(["properties","$"],function(k,h){function l(b){return"number"===typeof b?b.toFixed(2):b}for(var n=b,m=0;m<e.length;++m)n=n.replace("{{"+e[m]+"}}",l(k()[e[m]]));h(c).html(n)})}};
Cable.json=function(c){return{url:c,main:Cable.withArgs(["$","url","result"],function(b,c,k){var h=/^http/.test(c())&&!/callback=/.test(c());b.ajax({dataType:"json",url:c(),crossDomain:!!h,success:function(b){k(b)}})})}};Cable.text=function(c){return Cable.withArgs(["$","result"],function(b,e){b.ajax({url:c,dataType:"text",success:function(b){e(b)}})})};
Cable.decorators=function(){return function(c,b){var e={};c("[cable]").each(function(b,h){c(h).is(":text")?e[h.id]=Cable.textbox("#"+h.id):e[h.id]=Cable.template("#"+h.id,h.innerText)});b(e)}};
