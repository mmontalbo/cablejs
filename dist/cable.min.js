/*.......................................
. cablejs: By Wyatt Allen, MIT Licenced .
. 2014-03-31T21:59:47.145Z              .
.......................................*/
'use strict';var Cable={};
(function(){function a(b,e){for(var g in b)b.hasOwnProperty(g)&&e(b[g],g)}function d(b){return b.argAliases?b.argAliases:(b+"").match(/^function(\s*)?\(([^)]*)\)/m)[2].split(",").map(function(b){return b.replace(/(^\s+)|(\s+$)/g,"")})}function c(b,e){return d(b).filter(function(b){return-1==r.indexOf(b)}).map(function(b){return b.replace(/^_/,"")})}function k(b,e){return d(b).filter(function(b){return-1==r.indexOf(b)&&"_"!=b[0]})}function h(b){var e={};return b&&"[object Function]"===e.toString.call(b)}
function l(b,e){if(e){var g={};a(b,function(b,f){g[f]=e.hasOwnProperty(f)?e[f]:b});return g}return b}function n(b){function e(g){if(g.length){var d=g[0],a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var b="("+this.responseText+")";delete f[d];var a={};try{a[d]=eval(b)}catch(c){throw"Failed to load module '"+d+"': "+c;}Cable.define(a,{reify:!1,wireup:!1});e(g.slice(1))}};a.open("get",f[d].url,!0);a.send()}else b()}var g=[],d;for(d in f)f.hasOwnProperty(d)&&
"module"===f[d].type&&g.push(d);e(g)}function m(b,e){for(var g=e.chain,d="main"===b?"":"_"+b,a=[],c=0;c<g.length;++c)a.push(g.slice(0,g.length-c).join("_")+d);a.push(b);for(g=0;g<a.length;++g)if(f.hasOwnProperty(a[g]))return"alias"===f[a[g]].type?(a=f[a[g]],m(a.reference,a.scope)):a[g];return null}function v(){a(f,function(b){b.out=[]});a(f,function(b,e){b.fn&&k(b.fn,b.context).forEach(function(g){var a=m(g,b.scope);if(a)f[a].out.push(e);else throw"Reference to undefined node '"+g+"' as dependency of '"+
e+"'";})})}function x(){a(f,function(b,e){if("subdefinition"===b.type)if(y(e))s(e,function(g){g.splice(b.defineIndex,0,function(g){var a={};a[e]=g;Cable.define(a,{scope:b.scope})});delete f[e];b.fn.apply(window,g)});else throw"Illegal subdefinition: "+e+". Subdefs must depend only on libraries";})}function z(){a(f,function(b,e){"event"!==b.type||b.isWiredUp||(b.wireup(function(b){p(e,function(e){e(b)})}),b.isWiredUp=!0)})}function p(b,e){if(f.hasOwnProperty(b))A[f[b].type](b,e);else throw"Cannot generate: '"+
b+"' is not defined";}function q(b,e,g,a){void 0===g&&(g=[]);b.length?a&&a.hasOwnProperty(b[0])?q(b.slice(1),e,g.concat([a[b[0]]]),a):p(b[0],function(f){q(b.slice(1),e,g.concat([f]),a)}):e(g)}function s(b,e){var a=f[b]["in"].map(function(e){return m(e,f[b].scope)});q(a,e)}function t(b,e){B[f[b].type](b,e)}function u(b){t(b,function(){})}function y(b){return f[b]["in"].map(function(e){return"library"===f[m(e,f[b].scope)].type}).reduce(function(b,a){return b&&a})}var r=["result","respond","type","event",
"define"],f={};Cable._debug=function(){return f};Cable.each=a;Cable.define=function(b,e){e=l({reify:!0,wireup:!0,scope:{chain:[]}},e);a(b,function(b,a){if(/^_/.test(a))throw"Illegal definition: names cannot begin with an underscore.";if(-1!=r.indexOf(a))throw"Illegal definition: "+a+" is a reserved word.";if(f.hasOwnProperty(a))throw"Illegal definition: "+a+" is already defined.";var c=null;b.hasOwnProperty("type")?c=b.type:h(b)?(c=b,-1!=d(c).indexOf("result")||-1!=d(c).indexOf("respond")?c="synthetic":
-1!==d(b).indexOf("define")?c="subdefinition":(c=d(b),1===c.length&&"event"===c[0]?(c="event",b={type:"event",wireup:b}):c="effect")):c="scope";if(w.hasOwnProperty(c))w[c](a,b,e.scope);else throw"Illegal definiton: could not determine meaning of "+a;});(e.reify||e.wireup)&&n(function(){e.reify&&(v(),x(),v());e.wireup&&z()})};var w={data:function(b,e,a){f[b]={type:"data",value:e.value,"in":[],out:[],helpers:e.helpers?e.helpers:{},scope:a}},synthetic:function(b,e,a){-1!=d(e).indexOf("respond")?f[b]=
{type:"synthetic",fn:e,value:null,invoked:!1,"in":c(e,e.context),out:[],resultIndex:d(e).indexOf("respond"),scope:a,coalesce:!1}:f[b]={type:"synthetic",fn:e,value:null,invoked:!1,"in":c(e,e.context),out:[],resultIndex:d(e).indexOf("result"),scope:a,coalesce:!0}},effect:function(b,e,a){f[b]={type:"effect",fn:e,"in":c(e,e.context),out:[],scope:a}},event:function(b,a,d){f[b]={type:"event",value:a.defaultValue,wireup:a.wireup,isWiredUp:!1,invoked:!1,"in":[],out:[],scope:d}},library:function(b,a,d){f[b]=
{type:"library",path:a.path,shim:a.shim,handle:null,loaded:!1,scope:d}},scope:function(b,e,d){var f={};a(e,function(a,e){f["main"===e?b:b+"_"+e]=a});Cable.define(f,{reify:!1,wireup:!1,scope:{chain:d.chain.concat([b.replace(/^.+_/,"")])}})},subdefinition:function(b,a,g){f[b]={type:"subdefinition",in:c(a),fn:a,scope:g,defineIndex:d(a).indexOf("define")}},module:function(b,a,d){f[b]={type:"module",url:a.url,scope:d}},alias:function(b,a,d){f[b]={type:"alias",reference:a.reference,scope:d}}},A={data:function(b,
e){var d=function(){if(!arguments.length)return f[b].value;arguments[0]!=f[b].value&&(f[b].value=arguments[0],f[b].out.forEach(u))};a(f[b].helpers,function(b,a){d[a]=function(){return b.apply(d,arguments)}});e(d)},synthetic:function(b,a){f[b].invoked?a(function(){return f[b].value}):t(b,function(){})},effect:function(){},event:function(b,a){a(function(){if(!arguments.length)return f[b].value;arguments[0]==f[b].value&&f[b].coalesce||(f[b].invoked=!0,f[b].value=arguments[0],f[b].out.forEach(u))})},
library:function(b,a){f[b].loaded?a(f[b].handle):t(b,function(){p(b,a)})}},B={data:p.data,event:p.event,synthetic:function(b,a){s(b,function(d){d.splice(f[b].resultIndex,0,function(d){f[b].invoked=!0;f[b].value==d&&f[b].coalesce||(f[b].value=d,f[b].out.forEach(u));a()});f[b].fn.apply({},d)})},effect:function(b,a){s(b,function(d){f[b].fn.apply({},d);a()})},library:function(b,a){if(f[b].loaded)a();else{var d=function(){var a,d,e={},c=0;arguments[c].substring&&c++;a=arguments[c].splice?arguments[c++]:
["require","exports","module"];if(h(arguments[c])){var k=arguments[c];d=-1!==a.indexOf("exports")?function(){var b=k.apply(window,arguments);return void 0!==b?b:e}:k}else{var g=arguments[c];d=function(){return g}}q(a,function(a){f[b].handle=d.apply(window,a);f[b].loaded=!0},[],{require:function(){throw"Cable.js AMD loader does not support CommonJS style require.";},exports:e,module:null})};d.amd={};var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var c=
this.responseText;f[b].shim&&(c=["define(function() {",c,"\nreturn ",f[b].shim,"; });"].join(""));window.define=d;eval(c);delete window.define;"$"===b&&$&&$.noConflict&&$.noConflict();a()}};c.open("get",f[b].path,!0);c.send()}}};Cable.initialize=function(b,a){"synthetic"===f[b].type&&(f[b].value=a,f[b].invoked=!0)}})();Cable.withArgs=function(a,d){d.argAliases=a;return d};Cable.data=function(a,d){var c={type:"data",value:a};d&&(c.helpers=d);return c};Cable.define({init:{type:"event",wireup:function(a){a(new Date)}}},{reify:!1,wireup:!1});
Cable.list=function(a){return{array:Cable.data(a),main:Cable.data({type:"initialize",array:a},{insertAt:function(a,c){this({type:"insert",index:a,element:c})},prepend:function(a){this({type:"insert",index:0,element:a})},append:function(a){this({type:"insert",index:-1,element:a})},updateAt:function(a,c){this({type:"update",index:a,updates:c})},deleteAt:function(a){this({type:"delete",index:a})}}),updater:Cable.withArgs(["main","_array"],function(a,c){var k=a(),h=c().slice(0);if("insert"===k.type)h.splice(0<=
k.index?k.index:h.length,0,k.element);else if("update"===k.type)for(var l in k.updates)k.updates.hasOwnProperty(l)&&(h[k.index][l]=k.updates[l]);else"delete"===k.type&&h.splice(k.index,1);c(h)})}};
Cable.interval=function(a,d){if(a.substring){var c=[a,"_pid"];d&&(c=c.concat("init"));return{pid:Cable.data(-1),main:Cable.withArgs(c,function(a,d,c){clearInterval(d());a=setInterval(function(){c(new Date)},a());d(a)})}}return{type:"event",defaultValue:new Date,wireup:function(c){setInterval(function(){c(new Date)},a);d&&c(new Date)}}};Cable.library=function(a,d){return{type:"library",path:a,shim:d}};Cable.module=function(a){return{type:"module",url:a}};
Cable.pack=function(a){var d=function(a){for(var k={},h=1;h<d.argAliases.length;++h)k[d.argAliases[h]]=arguments[h]();a(k)};a=a.slice(0);a.splice(0,0,"result");d.argAliases=a;return d};Cable.counter=function(){return Cable.data(-1,{next:function(){var a=this()+1;this(a);return a}})};Cable.alias=function(a){return{type:"alias",reference:a}};Cable.textbox=function(a){return Cable.withArgs(["$","define"],function(d,c){c(Cable.withArgs(["event"],function(c){var h=d(a),l=function(){return h.is("[type='number']")?parseFloat(h.val()):h.val()};h.on("change keyup",function(){c(l())});c(l())}))})};Cable.checkbox=function(a){return Cable.withArgs(["$","define"],function(d,c){var k=d(a);c(Cable.withArgs(["event"],function(a){k.on("change",function(){a(k.is(":checked"))});a(k.is(":checked"))}))})};
Cable.button=function(a){return Cable.withArgs(["$","define"],function(d,c){c(Cable.withArgs(["event"],function(c){d(a).on("click",function(){c(new Date)})}))})};Cable.returnKey=function(a){return Cable.withArgs(["$","define"],function(d,c){c({type:"event",wireup:function(c){d(a).on("keyup",function(a){13===a.keyCode&&c(new Date)})}})})};
Cable.template=function(a,d){var c=(d.match(/\{\{[_a-zA-Z0-9]+\}\}/g)||[]).map(function(a){return a.replace(/\{|\}/g,"")});return{properties:Cable.pack(c),main:Cable.withArgs(["properties","$"],function(k,h){function l(a){return"number"===typeof a?a.toFixed(2):a}for(var n=d,m=0;m<c.length;++m)n=n.replace("{{"+c[m]+"}}",l(k()[c[m]]));h(a).html(n)})}};
Cable.json=function(a){return{url:a,main:Cable.withArgs(["$","url","result"],function(a,c,k){var h=/^http/.test(c())&&!/callback=/.test(c());a.ajax({dataType:"json",url:c(),crossDomain:!!h,success:function(a){k(a)}})})}};Cable.text=function(a){return Cable.withArgs(["$","result"],function(d,c){d.ajax({url:a,dataType:"text",success:function(a){c(a)}})})};
Cable.decorators=function(){return Cable.withArgs(["$","define"],function(a,d){var c={};a("[cable]").each(function(d,h){a(h).is(":text")?c[h.id]=Cable.textbox("#"+h.id):c[h.id]=Cable.template("#"+h.id,h.innerText)});d(c)})};
